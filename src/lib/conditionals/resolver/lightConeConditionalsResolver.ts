import Adversarial from 'lib/conditionals/lightcone/3star/Adversarial'
import Amber from 'lib/conditionals/lightcone/3star/Amber'
import Arrows from 'lib/conditionals/lightcone/3star/Arrows'
import Chorus from 'lib/conditionals/lightcone/3star/Chorus'
import CollapsingSky from 'lib/conditionals/lightcone/3star/CollapsingSky'
import Cornucopia from 'lib/conditionals/lightcone/3star/Cornucopia'
import DartingArrow from 'lib/conditionals/lightcone/3star/DartingArrow'
import DataBank from 'lib/conditionals/lightcone/3star/DataBank'
import Defense from 'lib/conditionals/lightcone/3star/Defense'
import FineFruit from 'lib/conditionals/lightcone/3star/FineFruit'
import HiddenShadow from 'lib/conditionals/lightcone/3star/HiddenShadow'
import Loop from 'lib/conditionals/lightcone/3star/Loop'
import Mediation from 'lib/conditionals/lightcone/3star/Mediation'
import MeshingCogs from 'lib/conditionals/lightcone/3star/MeshingCogs'
import Multiplication from 'lib/conditionals/lightcone/3star/Multiplication'
import MutualDemise from 'lib/conditionals/lightcone/3star/MutualDemise'
import Passkey from 'lib/conditionals/lightcone/3star/Passkey'
import Pioneering from 'lib/conditionals/lightcone/3star/Pioneering'
import Reminiscence from 'lib/conditionals/lightcone/3star/Reminiscence'
import Sagacity from 'lib/conditionals/lightcone/3star/Sagacity'
import Shadowburn from 'lib/conditionals/lightcone/3star/Shadowburn'
import ShatteredHome from 'lib/conditionals/lightcone/3star/ShatteredHome'
import Void from 'lib/conditionals/lightcone/3star/Void'
import ADreamScentedInWheat from 'lib/conditionals/lightcone/4star/ADreamScentedInWheat'
import AfterTheCharmonyFall from 'lib/conditionals/lightcone/4star/AfterTheCharmonyFall'
import ASecretVow from 'lib/conditionals/lightcone/4star/ASecretVow'
import ATrailOfBygoneBlood from 'lib/conditionals/lightcone/4star/ATrailOfBygoneBlood'
import BeforeTheTutorialMissionStarts from 'lib/conditionals/lightcone/4star/BeforeTheTutorialMissionStarts'
import BoundlessChoreo from 'lib/conditionals/lightcone/4star/BoundlessChoreo'
import CarveTheMoonWeaveTheClouds from 'lib/conditionals/lightcone/4star/CarveTheMoonWeaveTheClouds'
import ConcertForTwo from 'lib/conditionals/lightcone/4star/ConcertForTwo'
import DanceDanceDance from 'lib/conditionals/lightcone/4star/DanceDanceDance'
import DayOneOfMyNewLife from 'lib/conditionals/lightcone/4star/DayOneOfMyNewLife'
import DestinysThreadsForewoven from 'lib/conditionals/lightcone/4star/DestinysThreadsForewoven'
import DreamsMontage from 'lib/conditionals/lightcone/4star/DreamsMontage'
import DreamvilleAdventure from 'lib/conditionals/lightcone/4star/DreamvilleAdventure'
import EyesOfThePrey from 'lib/conditionals/lightcone/4star/EyesOfThePrey'
import Fermata from 'lib/conditionals/lightcone/4star/Fermata'
import FinalVictor from 'lib/conditionals/lightcone/4star/FinalVictor'
import FlamesAfar from 'lib/conditionals/lightcone/4star/FlamesAfar'
import ForTomorrowsJourney from 'lib/conditionals/lightcone/4star/ForTomorrowsJourney'
import GeniusesGreetings from 'lib/conditionals/lightcone/4star/GeniusesGreetings'
import GeniusesRepose from 'lib/conditionals/lightcone/4star/GeniusesRepose'
import GoodNightAndSleepWell from 'lib/conditionals/lightcone/4star/GoodNightAndSleepWell'
import HeyOverHere from 'lib/conditionals/lightcone/4star/HeyOverHere'
import HolidayThermaeEscapade from 'lib/conditionals/lightcone/4star/HolidayThermaeEscapade'
import IndeliblePromise from 'lib/conditionals/lightcone/4star/IndeliblePromise'
import InPursuitOfTheWind from 'lib/conditionals/lightcone/4star/InPursuitOfTheWind'
import ItsShowtime from 'lib/conditionals/lightcone/4star/ItsShowtime'
import JourneyForeverPeaceful from 'lib/conditionals/lightcone/4star/JourneyForeverPeaceful'
import LandausChoice from 'lib/conditionals/lightcone/4star/LandausChoice'
import MakeTheWorldClamor from 'lib/conditionals/lightcone/4star/MakeTheWorldClamor'
import MemoriesOfThePast from 'lib/conditionals/lightcone/4star/MemoriesOfThePast'
import NinjaRecordSoundHunt from 'lib/conditionals/lightcone/4star/NinjaRecordSoundHunt'
import NowhereToRun from 'lib/conditionals/lightcone/4star/NowhereToRun'
import OnlySilenceRemains from 'lib/conditionals/lightcone/4star/OnlySilenceRemains'
import PastAndFuture from 'lib/conditionals/lightcone/4star/PastAndFuture'
import PerfectTiming from 'lib/conditionals/lightcone/4star/PerfectTiming'
import PlanetaryRendezvous from 'lib/conditionals/lightcone/4star/PlanetaryRendezvous'
import PoisedToBloom from 'lib/conditionals/lightcone/4star/PoisedToBloom'
import PostOpConversation from 'lib/conditionals/lightcone/4star/PostOpConversation'
import QuidProQuo from 'lib/conditionals/lightcone/4star/QuidProQuo'
import ResolutionShinesAsPearlsOfSweat from 'lib/conditionals/lightcone/4star/ResolutionShinesAsPearlsOfSweat'
import ReturnToDarkness from 'lib/conditionals/lightcone/4star/ReturnToDarkness'
import RiverFlowsInSpring from 'lib/conditionals/lightcone/4star/RiverFlowsInSpring'
import SeeYouAtTheEnd from 'lib/conditionals/lightcone/4star/SeeYouAtTheEnd'
import ShadowedByNight from 'lib/conditionals/lightcone/4star/ShadowedByNight'
import SharedFeeling from 'lib/conditionals/lightcone/4star/SharedFeeling'
import SubscribeForMore from 'lib/conditionals/lightcone/4star/SubscribeForMore'
import SweatNowCryLess from 'lib/conditionals/lightcone/4star/SweatNowCryLess'
import Swordplay from 'lib/conditionals/lightcone/4star/Swordplay'
import TakeFlightTowardAPinkTomorrow from 'lib/conditionals/lightcone/4star/TakeFlightTowardAPinkTomorrow'
import TheBirthOfTheSelf from 'lib/conditionals/lightcone/4star/TheBirthOfTheSelf'
import TheDayTheCosmosFell from 'lib/conditionals/lightcone/4star/TheDayTheCosmosFell'
import TheFlowerRemembers from 'lib/conditionals/lightcone/4star/TheFlowerRemembers'
import TheForeverVictual from 'lib/conditionals/lightcone/4star/TheForeverVictual'
import TheGreatCosmicEnterprise from 'lib/conditionals/lightcone/4star/TheGreatCosmicEnterprise'
import TheMolesWelcomeYou from 'lib/conditionals/lightcone/4star/TheMolesWelcomeYou'
import TheSeriousnessOfBreakfast from 'lib/conditionals/lightcone/4star/TheSeriousnessOfBreakfast'
import TheStorysNextPage from 'lib/conditionals/lightcone/4star/TheStorysNextPage'
import ThisIsMe from 'lib/conditionals/lightcone/4star/ThisIsMe'
import TodayIsAnotherPeacefulDay from 'lib/conditionals/lightcone/4star/TodayIsAnotherPeacefulDay'
import TrendOfTheUniversalMarket from 'lib/conditionals/lightcone/4star/TrendOfTheUniversalMarket'
import UnderTheBlueSky from 'lib/conditionals/lightcone/4star/UnderTheBlueSky'
import UntoTomorrowsMorrow from 'lib/conditionals/lightcone/4star/UntoTomorrowsMorrow'
import VictoryInABlink from 'lib/conditionals/lightcone/4star/VictoryInABlink'
import WarmthShortensColdNights from 'lib/conditionals/lightcone/4star/WarmthShortensColdNights'
import WeAreWildfire from 'lib/conditionals/lightcone/4star/WeAreWildfire'
import WeWillMeetAgain from 'lib/conditionals/lightcone/4star/WeWillMeetAgain'
import WhatIsReal from 'lib/conditionals/lightcone/4star/WhatIsReal'
import WoofWalkTime from 'lib/conditionals/lightcone/4star/WoofWalkTime'
import AGroundedAscent from 'lib/conditionals/lightcone/5star/AGroundedAscent'
import AlongThePassingShore from 'lib/conditionals/lightcone/5star/AlongThePassingShore'
import AnInstantBeforeAGaze from 'lib/conditionals/lightcone/5star/AnInstantBeforeAGaze'
import AThanklessCoronation from 'lib/conditionals/lightcone/5star/AThanklessCoronation'
import BaptismOfPureThought from 'lib/conditionals/lightcone/5star/BaptismOfPureThought'
import BeforeDawn from 'lib/conditionals/lightcone/5star/BeforeDawn'
import BrighterThanTheSun from 'lib/conditionals/lightcone/5star/BrighterThanTheSun'
import ButTheBattleIsntOver from 'lib/conditionals/lightcone/5star/ButTheBattleIsntOver'
import CruisingInTheStellarSea from 'lib/conditionals/lightcone/5star/CruisingInTheStellarSea'
import DanceAtSunset from 'lib/conditionals/lightcone/5star/DanceAtSunset'
import EarthlyEscapade from 'lib/conditionals/lightcone/5star/EarthlyEscapade'
import EchoesOfTheCoffin from 'lib/conditionals/lightcone/5star/EchoesOfTheCoffin'
import EpochEtchedInGoldenBlood from 'lib/conditionals/lightcone/5star/EpochEtchedInGoldenBlood'
import EternalCalculus from 'lib/conditionals/lightcone/5star/EternalCalculus'
import FlameOfBloodBlazeMyPath from 'lib/conditionals/lightcone/5star/FlameOfBloodBlazeMyPath'
import FlowingNightglow from 'lib/conditionals/lightcone/5star/FlowingNightglow'
import IfTimeWereAFlower from 'lib/conditionals/lightcone/5star/IfTimeWereAFlower'
import IncessantRain from 'lib/conditionals/lightcone/5star/IncessantRain'
import InherentlyUnjustDestiny from 'lib/conditionals/lightcone/5star/InherentlyUnjustDestiny'
import InTheNameOfTheWorld from 'lib/conditionals/lightcone/5star/InTheNameOfTheWorld'
import InTheNight from 'lib/conditionals/lightcone/5star/InTheNight'
import IntotheUnreachableVeil from 'lib/conditionals/lightcone/5star/IntotheUnreachableVeil'
import IShallBeMyOwnSword from 'lib/conditionals/lightcone/5star/IShallBeMyOwnSword'
import IVentureForthToHunt from 'lib/conditionals/lightcone/5star/IVentureForthToHunt'
import LiesAflutterInTheWind from 'lib/conditionals/lightcone/5star/LiesAflutterInTheWind'
import LifeShouldBeCastToFlames from 'lib/conditionals/lightcone/5star/LifeShouldBeCastToFlames'
import LongRoadLeadsHome from 'lib/conditionals/lightcone/5star/LongRoadLeadsHome'
import MakeFarewellsMoreBeautiful from 'lib/conditionals/lightcone/5star/MakeFarewellsMoreBeautiful'
import MayRainbowsRemainInTheSky from 'lib/conditionals/lightcone/5star/MayRainbowsRemainInTheSky'
import MemorysCurtainNeverFalls from 'lib/conditionals/lightcone/5star/MemorysCurtainNeverFalls'
import MomentOfVictory from 'lib/conditionals/lightcone/5star/MomentOfVictory'
import NeverForgetHerFlame from 'lib/conditionals/lightcone/5star/NeverForgetHerFlame'
import NightOfFright from 'lib/conditionals/lightcone/5star/NightOfFright'
import NightOnTheMilkyWay from 'lib/conditionals/lightcone/5star/NightOnTheMilkyWay'
import NinjutsuInscriptionDazzlingEvilbreaker from 'lib/conditionals/lightcone/5star/NinjutsuInscriptionDazzlingEvilbreaker'
import OnTheFallOfAnAeon from 'lib/conditionals/lightcone/5star/OnTheFallOfAnAeon'
import PastSelfInTheMirror from 'lib/conditionals/lightcone/5star/PastSelfInTheMirror'
import PatienceIsAllYouNeed from 'lib/conditionals/lightcone/5star/PatienceIsAllYouNeed'
import ReforgedRemembrance from 'lib/conditionals/lightcone/5star/ReforgedRemembrance'
import SailingTowardsASecondLife from 'lib/conditionals/lightcone/5star/SailingTowardsASecondLife'
import ScentAloneStaysTrue from 'lib/conditionals/lightcone/5star/ScentAloneStaysTrue'
import SheAlreadyShutHerEyes from 'lib/conditionals/lightcone/5star/SheAlreadyShutHerEyes'
import SleepLikeTheDead from 'lib/conditionals/lightcone/5star/SleepLikeTheDead'
import SolitaryHealing from 'lib/conditionals/lightcone/5star/SolitaryHealing'
import SomethingIrreplaceable from 'lib/conditionals/lightcone/5star/SomethingIrreplaceable'
import TextureOfMemories from 'lib/conditionals/lightcone/5star/TextureOfMemories'
import TheHellWhereIdealsBurn from 'lib/conditionals/lightcone/5star/TheHellWhereIdealsBurn'
import TheUnreachableSide from 'lib/conditionals/lightcone/5star/TheUnreachableSide'
import ThisLoveForever from 'lib/conditionals/lightcone/5star/ThisLoveForever'
import ThoseManySprings from 'lib/conditionals/lightcone/5star/ThoseManySprings'
import ThusBurnsTheDawn from 'lib/conditionals/lightcone/5star/ThusBurnsTheDawn'
import TimeWaitsForNoOne from 'lib/conditionals/lightcone/5star/TimeWaitsForNoOne'
import TimeWovenIntoGold from 'lib/conditionals/lightcone/5star/TimeWovenIntoGold'
import WhereaboutsShouldDreamsRest from 'lib/conditionals/lightcone/5star/WhereaboutsShouldDreamsRest'
import WhyDoesTheOceanSing from 'lib/conditionals/lightcone/5star/WhyDoesTheOceanSing'
import WorrisomeBlissful from 'lib/conditionals/lightcone/5star/WorrisomeBlissful'
import YetHopeIsPriceless from 'lib/conditionals/lightcone/5star/YetHopeIsPriceless'
import {
  ElementName,
  PathName,
} from 'lib/constants/constants'
import { LightConeConditionalsController } from 'types/conditionals'
import { SuperImpositionLevel } from 'types/lightCone'
import ThoughWorldsApart from '../lightcone/5star/ThoughWorldsApart'
import ToEvernightsStars from '../lightcone/5star/ToEvernightsStars'

export type WearerMetadata = { element: ElementName }

export type LightConeConditionalFunction = (s: SuperImpositionLevel, withContent: boolean, wearerMetadata: WearerMetadata) => LightConeConditionalsController

const fiveStar: Record<string, LightConeConditionalFunction> = {
  23000: NightOnTheMilkyWay,
  23001: InTheNight,
  23002: SomethingIrreplaceable,
  23003: ButTheBattleIsntOver,
  23004: InTheNameOfTheWorld, // Skill atk buff not implemented
  23005: MomentOfVictory,
  23006: PatienceIsAllYouNeed, // Revisit dot
  23007: IncessantRain,
  23008: EchoesOfTheCoffin,
  23009: TheUnreachableSide,
  23010: BeforeDawn,
  23011: SheAlreadyShutHerEyes,
  23012: SleepLikeTheDead,
  23013: TimeWaitsForNoOne,
  23014: IShallBeMyOwnSword,
  23015: BrighterThanTheSun,
  23016: WorrisomeBlissful,
  23017: NightOfFright,
  23018: AnInstantBeforeAGaze,
  23019: PastSelfInTheMirror,
  23020: BaptismOfPureThought,
  23021: EarthlyEscapade,
  23022: ReforgedRemembrance,
  23023: InherentlyUnjustDestiny,
  23024: AlongThePassingShore,
  23025: WhereaboutsShouldDreamsRest,
  23026: FlowingNightglow,
  23027: SailingTowardsASecondLife,
  23028: YetHopeIsPriceless,
  23029: ThoseManySprings,
  23030: DanceAtSunset,
  23031: IVentureForthToHunt,
  23032: ScentAloneStaysTrue,
  23033: NinjutsuInscriptionDazzlingEvilbreaker,
  23034: AGroundedAscent,
  23035: LongRoadLeadsHome,
  23049: ToEvernightsStars,
  23051: ThoughWorldsApart,
  23052: ThisLoveForever,
  23050: NeverForgetHerFlame,

  24000: OnTheFallOfAnAeon,
  24001: CruisingInTheStellarSea,
  24002: TextureOfMemories,
  24003: SolitaryHealing,
  24004: EternalCalculus,

  23036: TimeWovenIntoGold,
  23037: IntotheUnreachableVeil,
  23038: IfTimeWereAFlower,
  23039: FlameOfBloodBlazeMyPath,
  23040: MakeFarewellsMoreBeautiful,
  23041: LifeShouldBeCastToFlames,
  23043: LiesAflutterInTheWind,
  23042: MayRainbowsRemainInTheSky,

  24005: MemorysCurtainNeverFalls,

  23044: ThusBurnsTheDawn,
  23045: AThanklessCoronation,
  23046: TheHellWhereIdealsBurn,

  23047: WhyDoesTheOceanSing,
  23048: EpochEtchedInGoldenBlood,

  21053: JourneyForeverPeaceful,
  21054: TheStorysNextPage,
  21055: UntoTomorrowsMorrow,
  21056: InPursuitOfTheWind,
  21057: TheFlowerRemembers,
  21058: ATrailOfBygoneBlood,
  21060: ADreamScentedInWheat,
  21061: HolidayThermaeEscapade,
  21062: SeeYouAtTheEnd,
}

const fourStar: Record<string, LightConeConditionalFunction> = {
  21000: PostOpConversation,
  21001: GoodNightAndSleepWell,
  21002: DayOneOfMyNewLife,
  21003: OnlySilenceRemains,
  21004: MemoriesOfThePast,
  21005: TheMolesWelcomeYou,
  21006: TheBirthOfTheSelf,
  21007: SharedFeeling,
  21008: EyesOfThePrey,
  21009: LandausChoice,
  21010: Swordplay,
  21011: PlanetaryRendezvous,
  21012: ASecretVow,
  21013: MakeTheWorldClamor,
  21014: PerfectTiming, // Does the ohb apply after passives?
  21015: ResolutionShinesAsPearlsOfSweat,
  21016: TrendOfTheUniversalMarket, // Revisit dot
  21017: SubscribeForMore,
  21018: DanceDanceDance,
  21019: UnderTheBlueSky,
  21020: GeniusesRepose,
  21021: QuidProQuo,
  21022: Fermata,
  21023: WeAreWildfire,
  21024: RiverFlowsInSpring,
  21025: PastAndFuture,
  21026: WoofWalkTime,
  21027: TheSeriousnessOfBreakfast,
  21028: WarmthShortensColdNights,
  21029: WeWillMeetAgain, // Does this get affected by crit / dmg boosts?
  21030: ThisIsMe, // Def scaling dmg not implemented
  21031: ReturnToDarkness,
  21032: CarveTheMoonWeaveTheClouds,
  21033: NowhereToRun,
  21034: TodayIsAnotherPeacefulDay,
  21035: WhatIsReal,
  21036: DreamvilleAdventure,
  21037: FinalVictor,
  21038: FlamesAfar,
  21039: DestinysThreadsForewoven,
  21040: TheDayTheCosmosFell,
  21041: ItsShowtime,
  21042: IndeliblePromise,
  21043: ConcertForTwo,
  21044: BoundlessChoreo,
  21045: AfterTheCharmonyFall,
  21046: PoisedToBloom,
  21047: ShadowedByNight,
  21048: DreamsMontage,
  21050: VictoryInABlink,
  21051: GeniusesGreetings,
  21052: SweatNowCryLess,

  22000: BeforeTheTutorialMissionStarts,
  22001: HeyOverHere,
  22002: ForTomorrowsJourney,
  22003: NinjaRecordSoundHunt,
  22004: TheGreatCosmicEnterprise,
  22005: TheForeverVictual,
  22006: TakeFlightTowardAPinkTomorrow,
}

const threeStar: Record<string, LightConeConditionalFunction> = {
  20000: Arrows,
  20001: Cornucopia,
  20002: CollapsingSky,
  20003: Amber,
  20004: Void,
  20005: Chorus,
  20006: DataBank,
  20007: DartingArrow,
  20008: FineFruit,
  20009: ShatteredHome,
  20010: Defense,
  20011: Loop,
  20012: MeshingCogs,
  20013: Passkey,
  20014: Adversarial,
  20015: Multiplication,
  20016: MutualDemise,
  20017: Pioneering,
  20018: HiddenShadow,
  20019: Mediation,
  20020: Sagacity,

  20021: Shadowburn,
  20022: Reminiscence,
}

export const lightConeOptionMapping: Record<string, LightConeConditionalFunction> = {
  ...fiveStar,
  ...fourStar,
  ...threeStar,
}

export const LightConeConditionalsResolver = {
  get: (
    request: { lightCone: string, lightConeSuperimposition: number, lightConePath: PathName, path: PathName, element: ElementName },
    withContent = false,
  ): LightConeConditionalsController => {
    const lcFn = lightConeOptionMapping[request.lightCone]
    // GPU debugger should be able to use all light cones
    // Otherwise path mismatches disable light cone effects
    if (!lcFn || (request.lightConePath !== request.path && !globalThis?.WEBGPU_DEBUG)) {
      return {
        content: () => [],
        defaults: () => ({}),
        precomputeEffects: () => {
        },
        finalizeCalculations: () => {
        },
      }
    }
    return lcFn(request.lightConeSuperimposition - 1, withContent, { element: request.element })
  },
}
