import {
  Sets,
  Stats,
} from 'lib/constants/constants'
import {
  generateE6S5Test,
  testCharacter,
  testMains,
  testSets,
  testStatSpread,
} from 'lib/simulations/tests/simTestUtils'
import { expectSimResultsToMatch } from 'lib/simulations/tests/statSim/statSimTestUtils'
import {
  A_GROUNDED_ASCENT,
  ACHERON,
  ALONG_THE_PASSING_SHORE,
  ANAXA,
  EARTHLY_ESCAPADE,
  FLOWING_NIGHTGLOW,
  FU_XUAN,
  HUOHUO,
  JIAOQIU,
  LIFE_SHOULD_BE_CAST_TO_FLAMES,
  NIGHT_OF_FRIGHT,
  ROBIN,
  SHE_ALREADY_SHUT_HER_EYES,
  SPARKLE,
  SUNDAY,
  THOSE_MANY_SPRINGS,
} from 'lib/simulations/tests/testMetadataConstants'
import { Metadata } from 'lib/state/metadata'
import { test } from 'vitest'

Metadata.initialize()

test('Anaxa sim', () => {
  expectSimResultsToMatch(
    generateE6S5Test({
      character: testCharacter(ANAXA, LIFE_SHOULD_BE_CAST_TO_FLAMES),
      teammate0: testCharacter(SUNDAY, A_GROUNDED_ASCENT),
      teammate1: testCharacter(ROBIN, FLOWING_NIGHTGLOW),
      teammate2: testCharacter(HUOHUO, NIGHT_OF_FRIGHT),
      sets: testSets(Sets.ScholarLostInErudition, Sets.ScholarLostInErudition, Sets.RutilantArena),
      mains: testMains(Stats.CD, Stats.SPD, Stats.Wind_DMG, Stats.ATK_P),
      stats: testStatSpread(),
    }),
    {
      ATK: 2848.4648438,
      DEF: 1674.0800781,
      HP: 3651.2683105,
      SPD: 148.0319977,
      CR: 0.654,
      CD: 1.796,
      EHR: 0.432,
      RES: 0.432,
      BE: 0.648,
      OHB: 0,
      ERR: 0,
      ELEMENTAL_DMG: 0.6128,
    },
    {
      ATK: 5822.3603516,
      DEF: 1674.0800781,
      HP: 3651.2683105,
      SPD: 175.1921082,
      CR: 1.314,
      CD: 5.0139999,
      EHR: 0.432,
      RES: 0.932,
      BE: 0.648,
      OHB: 0,
      ERR: 0,
      ELEMENTAL_DMG: 5.2368002,
      EHP: 8966.4990234,
      HEAL_VALUE: 0,
      SHIELD_VALUE: 0,
      BASIC_DMG: 352794.5625,
      SKILL_DMG: 1359471.375,
      ULT_DMG: 564471.3125,
      FUA_DMG: 0,
      DOT_DMG: 0,
      BREAK_DMG: 35680.359375,
      MEMO_SKILL_DMG: 0,
      MEMO_TALENT_DMG: 0,
      COMBO_DMG: 5858483,
    },
  )
})

test('Acheron sim', () => {
  expectSimResultsToMatch(
    generateE6S5Test({
      character: testCharacter(ACHERON, ALONG_THE_PASSING_SHORE),
      teammate0: testCharacter(JIAOQIU, THOSE_MANY_SPRINGS),
      teammate1: testCharacter(SPARKLE, EARTHLY_ESCAPADE),
      teammate2: testCharacter(FU_XUAN, SHE_ALREADY_SHUT_HER_EYES),
      sets: testSets(Sets.PioneerDiverOfDeadWaters, Sets.PioneerDiverOfDeadWaters, Sets.IzumoGenseiAndTakamaDivineRealm),
      mains: testMains(Stats.CD, Stats.ATK_P, Stats.Lightning_DMG, Stats.ATK_P),
      stats: testStatSpread(),
    }),
    {
      ATK: 3948.1425781,
      DEF: 1283.574585,
      HP: 3832.8474121,
      SPD: 127,
      CR: 0.414,
      CD: 2.6359999,
      EHR: 0.432,
      RES: 0.432,
      BE: 0.648,
      OHB: 0,
      ERR: 0,
      ELEMENTAL_DMG: 0.4688,
    },
    {
      ATK: 4681.6137695,
      DEF: 1283.574585,
      HP: 4360.8476563,
      SPD: 127.0000992,
      CR: 1.026,
      CD: 5.632,
      EHR: 0.432,
      RES: 0.432,
      BE: 0.648,
      OHB: 0,
      ERR: 0,
      ELEMENTAL_DMG: 2.9607999,
      EHP: 32793.9453125,
      HEAL_VALUE: 0,
      SHIELD_VALUE: 0,
      BASIC_DMG: 434591.90625,
      SKILL_DMG: 695347.0625,
      ULT_DMG: 2179913,
      FUA_DMG: 0,
      DOT_DMG: 0,
      BREAK_DMG: 26575.1464844,
      MEMO_SKILL_DMG: 0,
      MEMO_TALENT_DMG: 0,
      COMBO_DMG: 3570607,
    },
  )
})

// test('Jingliu scholar preprocessor sim', () => {
//   expectSimResultsToMatch(
//     generateE6S5Test({
//       character: testCharacter(JINGLIU, I_SHALL_BE_MY_OWN_SWORD),
//       teammate0: testCharacter(BRONYA, BUT_THE_BATTLE_ISNT_OVER),
//       teammate1: testCharacter(RUAN_MEI, PAST_SELF_IN_MIRROR),
//       teammate2: testCharacter(HUOHUO, NIGHT_OF_FRIGHT),
//       sets: testSets(Sets.ScholarLostInErudition, Sets.ScholarLostInErudition, Sets.RutilantArena),
//       mains: testMains(Stats.CD, Stats.ATK_P, Stats.Ice_DMG, Stats.ATK_P),
//       stats: testStatSpread(),
//     }),
//     {
//       ATK: 3248.652832,
//       DEF: 1358.2800293,
//       HP: 4689.0083008,
//       SPD: 131,
//       CR: 0.534,
//       CD: 2.4890001,
//       EHR: 0.432,
//       RES: 0.432,
//       BE: 0.648,
//       OHB: 0,
//       ERR: 0,
//       ELEMENTAL_DMG: 0.3888,
//     },
//     {
//       ATK: 7670.6303711,
//       DEF: 1358.2800293,
//       HP: 4689.0083008,
//       SPD: 152.5041046,
//       CR: 1.0539999,
//       CD: 3.8650002,
//       EHR: 0.432,
//       RES: 0.782,
//       BE: 0.848,
//       OHB: 0,
//       ERR: 0,
//       ELEMENTAL_DMG: 4.0468001,
//       EHP: 10227.2568359,
//       HEAL_VALUE: 0,
//       SHIELD_VALUE: 0,
//       BASIC_DMG: 145666.828125,
//       SKILL_DMG: 614899.625,
//       ULT_DMG: 582882.125,
//       FUA_DMG: 0,
//       DOT_DMG: 0,
//       BREAK_DMG: 16481.2050781,
//       MEMO_SKILL_DMG: 0,
//       MEMO_TALENT_DMG: 0,
//       COMBO_DMG: 2380257.75,
//     },
//   )
// })
